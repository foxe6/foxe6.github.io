window.search_js=function(k){function n(a,b,e){$("div#search_result, div#search_result_header").show();$("div#search_filter div[id].rows div.row span.toggle").each(function(){$(this).hasClass("hide")||$(this).parent().click()});$("div#search_result div.row.first").show();k.api_post("request=search&keyword="+encodeURIComponent(a[0])+a[1]+"&page="+g,function(c,d){if(0===d.length)g=-1,b?$("div#search_result div#no_result").show():$("div#search_result div.row.last").hide();else{for(c=0;c<d.length;c++){var f=
d[c].name;a[0]&&(f=f.replace(new RegExp("("+a[0].replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+")","gi"),"<span style='background-color: var(--foxe6a);'>$1</span>"));$("div#search_result div.row.last").before(search_result_row.replace(/<src>/g,k.dialog_resource.img_src_mfcid.replace(/<mfcid>/g,d[c].mfcid)).replace(/<castoff>/g,d[c].castoff&&-1===document.cookie.indexOf("off_blur")?" class='blur'":"").replace(/<mfcid>/g,d[c].mfcid).replace(/<name>/g,f))}$("div#search_result div.row:not(.last)").off("click").click(k.image_preview_e)}$(window).trigger("resize");
e&&e()});g++}function l(a,b){return function(){var e=$("div#search_box form.simple div.input input").val(),c=$("div#search_filter form").serialize();c=c?"&"+c:"";if(a||!e&&!c)$("div#search_result div.row:not(.last)").remove(),$("div#search_result div.row.last").show();a&&(g=0);if(e||c){for(var d=Array.from(c.matchAll(/([a-z]+)=/g),function(p){return p}),f=[],h=0;h<d.length;h++)-1===f.indexOf(d[h][1])&&(f.push(d[h][1]),c+="&meta="+d[h][1]);n([e,c],a,b)}}}delete window.search_js;k.api_post("request=metadata",
function(a,b){for(a=0;a<b.length;a++)if(!(0>b[a][1])){var e=$("div#search_filter div#"+b[a][0]+" fieldset");e.attr("id",b[a][0]);e.append(label_input.replace(/<name>/g,b[a][0]).replace(/<meta>/g,b[a][0]).replace(/<key>/g,b[a][1]).replace(/<value>/g,b[a][2]))}$("div#search_filter div.table div.td#company").prev().click();$("div#search_filter div.table div.td#classification").prev().click();$("div#search_filter div#sorting div.row").click();window.location.search&&(b=window.location.search.match(/^\?([a-z]+)=([0-9]+)$/),
$("input[name='"+b[1]+"'][value='"+b[2]+"']").prop("checked",!0),$("div#search_submit").click())});$("div#search_filter div.table div.td span.toggle").parent().click(function(){var a=$(this).find("span.toggle");$(a).toggleClass("hide");$(a).hasClass("hide")?$(a).parent().next().children().hide().filter("div.toggle_hide_hint").show():$(a).parent().next().children().show().filter("div.toggle_hide_hint").hide();$(window).trigger("resize")});$("div#search_filter div[id].rows .row span.toggle").parent().click(function(){var a=
$(this).find("span.toggle");$(a).toggleClass("hide");$(a).hasClass("hide")?$(this).closest("div.rows").next().hide():$(this).closest("div.rows").next().show();$(window).trigger("resize")});$("input#filter_classification, input#filter_company").keyup(function(){var a=$(this).val().toLowerCase(),b=$(this).parent().parent().children("label");b.show();a&&b.each(function(){-1===$(this).text().trim().toLowerCase().indexOf(a)&&$(this).hide()})});var m,g=0;$("div#search div#search_icon, div#search_submit").click(l(!0,
function(){$("div#search_result_header")[0].scrollIntoView()}));$("div#search_box form.simple div.input input").keydown(function(a){13===a.keyCode&&(a.stopPropagation(),a.preventDefault(),$(this).blur(),l(!0,function(){$("div#search_result_header")[0].scrollIntoView()})())});$("div#search").scroll(function(){$(window).trigger("resize");clearTimeout(m);0>g||"none"!==getComputedStyle($("div#search_result")[0]).display&&($("div#search_result div.row.last").offset().top>.9*$(window).height()||(m=setTimeout(l(!1),
333)))});$("div#search_result div.row.last").click(l(!1));$(window).resize(function(){$("div#search_result.rows .row div.image").each(function(){$(this).css({height:$(this).width()+"px"})})});$("div#search_reset").click(function(){window.location.href="/search"});$("div#menu div#search_icon").off("click").click(function(){$("div#search_submit").click()})};
